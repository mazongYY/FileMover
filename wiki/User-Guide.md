# 用户指南

本指南详细介绍FileMover的所有功能和使用方法，帮助您充分利用这个强大的文件筛选工具。

## 📋 目录

1. [界面概览](#界面概览)
2. [文件选择](#文件选择)
3. [关键字筛选](#关键字筛选)
4. [操作模式](#操作模式)
5. [高级功能](#高级功能)
6. [输出管理](#输出管理)
7. [性能优化](#性能优化)
8. [最佳实践](#最佳实践)

## 🖥️ 界面概览

### 主界面布局

FileMover采用现代化的深色主题设计，界面分为四个主要区域：

```
┌─────────────────────────────────────────────────────────┐
│  📦 FileMover                    👁️ 预览  🚀 开始处理  │
├─────────────────────────────────────────────────────────┤
│  左侧面板                    │  右侧面板                │
│  ┌─────────────────────────┐  │  ┌─────────────────────┐ │
│  │  📁 文件选择            │  │  │  ⚙️ 操作模式        │ │
│  │                         │  │  │                     │ │
│  │  🔍 关键字设置          │  │  │  📊 处理状态        │ │
│  │                         │  │  │                     │ │
│  └─────────────────────────┘  │  └─────────────────────┘ │
└─────────────────────────────────────────────────────────┘
```

### 界面元素说明

- **顶部标题栏**: 显示程序名称和主要操作按钮
- **左侧面板**: 文件选择和关键字设置
- **右侧面板**: 操作模式选择和状态显示
- **底部状态栏**: 显示当前操作状态和进度

## 📂 文件选择

### 支持的文件格式

FileMover支持以下压缩格式：

| 格式 | 扩展名 | 支持程度 | 说明 |
|------|--------|----------|------|
| ZIP | .zip | ✅ 完全支持 | 最常用的压缩格式 |
| RAR | .rar | ✅ 完全支持 | 需要安装rarfile库 |
| 7Z | .7z | ✅ 完全支持 | 需要安装py7zr库 |

### 文件选择方法

#### 方法1：浏览按钮
1. 点击"📂 浏览文件"按钮
2. 在文件对话框中导航到目标文件
3. 选择压缩包文件并点击"打开"
4. 文件路径会自动填入输入框

#### 方法2：直接输入
1. 点击文件路径输入框
2. 清除占位符文本
3. 输入完整的文件路径
4. 支持相对路径和绝对路径

#### 方法3：拖拽操作（计划中）
- 直接将文件拖拽到程序界面
- 支持多文件同时拖拽
- 自动验证文件格式

### 文件信息显示

选择文件后，程序会显示：
- ✅ 文件名和大小
- 📍 文件路径
- 📊 压缩包基本信息

## 🔍 关键字筛选

### 基本筛选

#### 简单关键字
```
照片
文档
重要
2024
```

#### 文件扩展名
```
.jpg
.png
.pdf
.docx
.xlsx
```

#### 路径匹配
```
photos/
documents/
backup/
src/main/
```

### 高级筛选

#### 组合关键字
```
重要.pdf
2024照片
会议记录.docx
项目文档.zip
```

#### 日期模式
```
2024-12
2024年12月
12-19
2024/12/19
```

#### 大小写处理
- FileMover默认**不区分大小写**
- "Photo" 和 "photo" 会匹配相同的文件
- "JPG" 和 "jpg" 效果相同

### 筛选策略

#### 包含筛选（默认）
- 文件名包含任一关键字即匹配
- 适用于大部分筛选场景

#### 排除筛选（计划中）
```
!temp
!cache
!.tmp
```

#### 正则表达式（计划中）
```
\d{4}-\d{2}-\d{2}  # 匹配日期格式
.*\.log$           # 匹配日志文件
^IMG_\d+\.jpg$     # 匹配相机照片
```

## ⚙️ 操作模式

### 📁 移动文件

**功能描述**
- 将匹配的文件从压缩包中提取并移动到输出目录
- 原始压缩包保持不变
- 节省磁盘空间，避免文件重复

**适用场景**
- 整理和归档文件
- 清理压缩包内容
- 文件分类管理

**操作流程**
1. 解压匹配的文件到临时目录
2. 移动文件到输出目录
3. 清理临时文件
4. 显示处理结果

### 📋 复制文件

**功能描述**
- 将匹配的文件复制到输出目录
- 保留原始文件结构
- 安全性高，不影响原始数据

**适用场景**
- 文件备份
- 数据分享
- 安全的文件提取

**操作流程**
1. 解压匹配的文件到临时目录
2. 复制文件到输出目录
3. 保持文件属性和时间戳
4. 清理临时文件

### 🔗 创建链接

**功能描述**
- 为匹配的文件创建快捷方式
- 几乎不占用额外磁盘空间
- 快速访问和引用

**适用场景**
- 快速文件访问
- 节省磁盘空间
- 文件引用管理

**平台差异**
- **Windows**: 创建.lnk快捷方式
- **Linux/macOS**: 创建符号链接
- **跨平台**: 自动适配系统类型

## 🚀 高级功能

### 批量处理

#### 多文件处理
- 支持处理大型压缩包（GB级别）
- 智能内存管理
- 进度实时显示

#### 并行处理（计划中）
- 多线程文件提取
- 并行关键字匹配
- 显著提升处理速度

### 预览功能

#### 匹配预览
1. 点击"👁️ 预览匹配文件"
2. 查看将要处理的文件列表
3. 确认筛选结果
4. 调整关键字（如需要）

#### 预览信息
- 📁 文件名和路径
- 📊 文件大小
- 📅 修改时间
- 🏷️ 文件类型

### 自定义输出

#### 输出目录
- 默认：桌面/FileMover_Output
- 自定义：用户指定目录
- 自动创建：不存在时自动创建

#### 文件命名
- 保持原名：使用原始文件名
- 避免冲突：自动添加数字后缀
- 自定义前缀：添加用户定义前缀

## 📊 输出管理

### 输出结构

```
FileMover_Output/
├── 匹配文件/
│   ├── 照片1.jpg
│   ├── 文档1.pdf
│   └── 视频1.mp4
└── 未匹配文件/
    ├── 系统文件.log
    ├── 临时文件.tmp
    └── 其他文档.txt
```

### 文件组织

#### 按类型分类（计划中）
```
FileMover_Output/
├── 图片/
├── 文档/
├── 视频/
└── 其他/
```

#### 按日期分类（计划中）
```
FileMover_Output/
├── 2024-12/
├── 2024-11/
└── 其他/
```

### 冲突处理

#### 文件名冲突
- **自动重命名**: 添加数字后缀
- **跳过处理**: 保留原有文件
- **覆盖文件**: 替换同名文件

#### 示例
```
原文件: document.pdf
冲突时: document_1.pdf, document_2.pdf
```

## ⚡ 性能优化

### 处理大文件

#### 内存优化
- 流式处理：避免一次性加载所有文件
- 分块读取：按块处理大文件
- 垃圾回收：及时释放内存

#### 磁盘优化
- 临时目录：使用SSD作为临时存储
- 批量操作：减少磁盘I/O次数
- 压缩缓存：缓存常用压缩包信息

### 提升处理速度

#### 硬件建议
- **CPU**: 多核处理器，支持并行处理
- **内存**: 8GB+，处理大文件更流畅
- **存储**: SSD硬盘，提升I/O性能

#### 软件优化
- 关闭不必要的程序
- 使用本地磁盘作为输出目录
- 定期清理临时文件

## 💡 最佳实践

### 关键字设计

#### 精确匹配
```
# 好的例子
.jpg
2024-12
重要文档

# 避免的例子
a        # 太宽泛
文件     # 太通用
```

#### 分层筛选
```
# 第一层：文件类型
.pdf
.docx

# 第二层：内容分类
报告
总结

# 第三层：时间范围
2024
12月
```

### 工作流程

#### 标准流程
1. **准备阶段**: 确认压缩包和输出目录
2. **设置阶段**: 配置关键字和操作模式
3. **预览阶段**: 检查匹配结果
4. **执行阶段**: 开始处理
5. **验证阶段**: 检查输出结果

#### 批量处理
1. **规划阶段**: 制定处理计划
2. **测试阶段**: 小规模测试
3. **执行阶段**: 批量处理
4. **验证阶段**: 结果验证

### 安全建议

#### 数据安全
- 处理前备份重要文件
- 使用复制模式而非移动模式
- 定期检查输出结果

#### 系统安全
- 从可信来源下载压缩包
- 注意压缩包密码安全
- 及时清理临时文件

## 🔧 故障排除

### 常见问题

#### 程序无响应
- **原因**: 处理大文件或文件数量过多
- **解决**: 等待处理完成或重启程序

#### 内存不足
- **原因**: 可用内存不足
- **解决**: 关闭其他程序或增加虚拟内存

#### 文件访问错误
- **原因**: 文件被占用或权限不足
- **解决**: 关闭相关程序或以管理员身份运行

### 错误代码

| 错误代码 | 说明 | 解决方案 |
|----------|------|----------|
| E001 | 文件不存在 | 检查文件路径 |
| E002 | 格式不支持 | 使用支持的格式 |
| E003 | 权限不足 | 以管理员身份运行 |
| E004 | 磁盘空间不足 | 清理磁盘空间 |

---

**需要更多帮助？** 查看[常见问题](FAQ)或[创建Issue](https://github.com/mazongYY/FileMover/issues/new)获取支持。
